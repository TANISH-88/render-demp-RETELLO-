<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Prediction</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  html,body{
    height:100%;
    margin:0;
    overflow:hidden;
    font-family:Inter,system-ui;
    background:#0f172a;
    color:#e6eef8
  }

  .patreon-bg{
    position:fixed; inset:0; z-index:-2; pointer-events:none;
    background:radial-gradient(circle at 20% 40%,#ff6ec7 0%,transparent 60%),
    radial-gradient(circle at 80% 60%,#6ec7ff 0%,transparent 60%),
    radial-gradient(circle at 50% 80%,#a07bff 0%,transparent 60%),
    radial-gradient(circle at 30% 70%,#ff9f6e 0%,transparent 60%);
    background-size:200% 200%; filter:blur(160px) saturate(1.25);
    animation:moveGradients 45s ease-in-out infinite alternate
  }

  @keyframes moveGradients{
    0%{background-position:20% 30%,80% 60%,40% 70%,60% 40%}
    50%{background-position:30% 40%,70% 50%,50% 80%,40% 60%}
    100%{background-position:20% 30%,80% 60%,40% 70%,60% 40%}
  }

  .grain{
    position:fixed; inset:0; z-index:-1; opacity:0.02;
    pointer-events:none; mix-blend-mode:overlay;
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256"><filter id="f"><feTurbulence baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23f)"/></svg>');
    background-size:cover
  }

  .vignette{
    position:fixed; inset:0; z-index:0; pointer-events:none;
    background:radial-gradient(1000px 600px at 50% 50%,transparent 40%,rgba(0,0,0,.45));
    mix-blend-mode:multiply
  }

  .cursor{
    position:fixed; left:0; top:0; width:300px; height:300px;
    border-radius:50%; pointer-events:none; z-index:9999;
    background:radial-gradient(circle,rgba(255,255,255,0.12),
    rgba(56,189,248,0.05) 40%,transparent 70%);
    filter:blur(80px); transform:translate(-50%,-50%);
    mix-blend-mode:screen; transition:opacity 150ms linear
  }

  .container{
    position:relative; z-index:2; display:flex;
    height:100vh; padding:40px; box-sizing:border-box; gap:4%
  }

  @media(max-width:900px){
    .container{flex-direction:column; padding:20px}
  }

  .guide{
    width:48%; min-height:280px; padding:32px 36px;
    background:rgba(15,18,26,0.45); backdrop-filter:blur(12px) saturate(1.05);
    border-radius:16px; display:flex; flex-direction:column;
    transition:opacity 0.4s ease,transform 0.4s ease; overflow-y:auto
  }

  .guide.hiding{opacity:0; transform:translateY(8px)}
  .guide h2{color:rgb(237,96,44); margin:0 0 12px; font-size:26px}
  .guide p{margin:0; font-size:17px; line-height:1.7; color:#cfd4e0}

  .form{
    width:48%; display:flex; flex-direction:column;
    justify-content:center; padding:20px; gap:18px
  }

  .form input,.form select{
    width:100%; padding:16px; font-size:16px; border-radius:10px;
    border:none; background:rgba(30,41,59,0.7); color:#e6eef8
  }

  .form button{
    margin-top:20px; padding:16px 28px; font-size:17px;
    border-radius:10px; border:none; cursor:pointer;
    font-weight:600; background:rgb(237,96,44); color:#06202a
  }

  #result{
    margin-top:18px; padding:14px; border-radius:10px;
    display:none; width:100%; text-align:center; font-size:20px;
    background:#123624; color:#aaffaa; font-weight:700
  }

  #aiSuggestion{
    margin-top:18px; padding:14px; display:none;
    background:rgba(20,20,30,0.55); border-radius:10px
  }

  .image-gallery{
    margin-top:16px; display:flex; flex-wrap:wrap; gap:14px
  }

  .image-item{
    text-align:center; font-size:14px; color:#cfd4e0
  }

  .image-item img{
    width:220px; height:150px; object-fit:cover;
    border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,.4)
  }
</style>
</head>
<body>

<div class="patreon-bg"></div>
<div class="grain"></div>
<div class="vignette"></div>
<div id="cursor" class="cursor"></div>

<div class="container">
  <div class="guide" id="guideBox">
      <h2>Welcome to Rentello</h2>
      <p>Focus any field and AI will explain how that field affects rent predictions.</p>
      <div id="aiSuggestion"></div>
  </div>

  <div class="form">
      <input type="number" id="bedrooms" placeholder="Bedrooms">
      <input type="number" id="bathrooms" placeholder="Bathrooms">
      <input type="number" id="lotarea" placeholder="Lot Area">

      <select id="grade">
          <option value="">Grade (1–13)</option>
          <option value="1">1 - Basic</option>
          <option value="5">5 - Standard</option>
          <option value="9">9 - Premium</option>
          <option value="13">13 - Luxury</option>
      </select>

      <select id="condition">
          <option value="">Condition (1–5)</option>
          <option value="1">1 - Poor</option>
          <option value="3">3 - Good</option>
          <option value="5">5 - Excellent</option>
      </select>

      <select id="waterfront">
          <option value="">Waterfront</option>
          <option value="0">No</option>
          <option value="1">Yes</option>
      </select>

      <select id="views">
          <option value="">Views (0–4)</option>
          <option value="0">0 - None</option>
          <option value="2">2 - Good</option>
          <option value="4">4 - Panoramic</option>
      </select>

      <button id="predictBtn" type="button">Predict</button>
      <div id="result"></div>
  </div>
</div>

<script>
// Cursor Animation
(function(){ 
  const cursor=document.getElementById('cursor');
  let target={x:innerWidth/2,y:innerHeight/2},current={x:target.x,y:target.y};
  function lerp(a,b,t){return a+(b-a)*t}
  window.addEventListener('mousemove',e=>{target.x=e.clientX;target.y=e.clientY;cursor.style.opacity='1'});
  window.addEventListener('mouseleave',()=>cursor.style.opacity='0');
  (function anim(){
    current.x=lerp(current.x,target.x,0.08);
    current.y=lerp(current.y,target.y,0.08);
    cursor.style.left=current.x+'px';cursor.style.top=current.y+'px';
    requestAnimationFrame(anim)
  })(); 
})();

// Labels
const fieldLabels={
  bedrooms:"Bedrooms",
  bathrooms:"Bathrooms",
  lotarea:"Lot Area",
  grade:"Grade",
  condition:"Condition",
  waterfront:"Waterfront",
  views:"Views"
};

// Explanations
const fallbacks={
  bedrooms:`Bedrooms directly determine how many people can comfortably live in a house.`,
  bathrooms:`Bathrooms greatly influence comfort and rental desirability.`,
  lotarea:`Lot Area reflects outdoor space, parking, and property capacity.`,
  grade:`Grade means construction quality & finishing level.`,
  condition:`Condition shows property maintenance & repair status.`,
  waterfront:`Waterfront adds premium value & strong rental appeal.`,
  views:`Views significantly boost attraction & rental pricing.`
};

// IMAGES
const images = {

  bedrooms: [
    { src: "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?auto=format&fit=crop&w=1000&q=80", caption: "Cozy Bedroom" },
    { src: "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=1000&q=80", caption: "Spacious Bedroom" }
  ],

  bathrooms: [
    { src: "https://images.unsplash.com/photo-1584622650111-993a426fbf0a?auto=format&fit=crop&w=1000&q=80", caption: "Modern Bathroom" },
    // reuse working image so it always loads
    { src: "https://images.unsplash.com/photo-1584622650111-993a426fbf0a?auto=format&fit=crop&w=1000&q=80", caption: "Luxury Bathroom" }
  ],

  lotarea: [
    { src: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=1000&q=80", caption: "Large Backyard" },
    { src: "https://images.unsplash.com/photo-1516156008625-3a9d6067fab5?auto=format&fit=crop&w=1000&q=80", caption: "Open Lot Area" }
  ],

  // all four grades use the same known-working URL
  grade: [
  { src: "https://images.unsplash.com/photo-1493809842364-78817add7ffb?auto=format&fit=crop&w=1200&q=80", caption: "Grade 1: Basic" },
  { src: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?auto=format&fit=crop&w=1200&q=80", caption: "Grade 5: Standard" },
  { src: "https://images.unsplash.com/photo-1599423300746-b62533397364?auto=format&fit=crop&w=1200&q=80", caption: "Grade 9: Premium" },
  { src: "https://images.unsplash.com/photo-1594301279754-5c6f5108f8f6?auto=format&fit=crop&w=1200&q=80", caption: "Grade 13: Luxury" }
],


  condition: [
    { src: "https://images.unsplash.com/photo-1600880292089-90a7e086ee0c?auto=format&fit=crop&w=1000&q=80", caption: "Poor Condition" },
    { src: "https://images.unsplash.com/photo-1599423300746-b62533397364?auto=format&fit=crop&w=1000&q=80", caption: "Good Condition" },
    { src: "https://images.unsplash.com/photo-1600585153898-5f9e1eaa41da?auto=format&fit=crop&w=1000&q=80", caption: "Excellent Condition" }
  ],

  waterfront: [
    { src: "https://images.unsplash.com/photo-1505691723518-36a5ac3be353?auto=format&fit=crop&w=1000&q=80", caption: "Waterfront" },
    { src: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?auto=format&fit=crop&w=1000&q=80", caption: "Non-Waterfront" }
  ],

  views: [
    { src: "https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1000&q=80", caption: "No View" },
    { src: "https://images.unsplash.com/photo-1486308510493-aa64833637b1?auto=format&fit=crop&w=1000&q=80", caption: "Good View" },
    { src: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=1000&q=80", caption: "Panoramic View" }
  ]
};

// Update Guide
function updateGuide(field){
  const g=document.getElementById('guideBox');
  g.classList.add('hiding');
  setTimeout(()=>{
    g.innerHTML=`<h2>${fieldLabels[field]}</h2><p>${fallbacks[field]}</p><div id='aiSuggestion'></div>`;
    if(images[field]){
      const gallery=document.createElement('div');
      gallery.className="image-gallery";
      images[field].forEach(img=>{
        const div=document.createElement('div');
        div.className="image-item";
        div.innerHTML=`<img src="${img.src}" alt=""><br>${img.caption}`;
        gallery.appendChild(div);
      });
      g.appendChild(gallery);
    }
    g.classList.remove('hiding');
  },350);
}

['bedrooms','bathrooms','lotarea','grade','condition','waterfront','views']
.forEach(id=>{
  const el=document.getElementById(id);
  if(el){el.addEventListener('focus',()=>updateGuide(id)); el.addEventListener('click',()=>updateGuide(id));}
});

// Typewriter (for prediction text)
function typeWriter(el,text,speed=30){
  el.textContent="";
  let i=0;
  (function typing(){
    if(i<text.length){
      el.textContent+=text.charAt(i);
      i++;
      setTimeout(typing,speed);
    }
  })();
}

// Prediction Handling
document.getElementById('predictBtn').addEventListener('click', async ()=>{

  const data={
    bedrooms:bedrooms.value,
    bathrooms:bathrooms.value,
    lotarea:lotarea.value,
    grade:grade.value,
    condition:condition.value,
    waterfront:waterfront.value,
    views:views.value
  };

  const resultDiv=document.getElementById('result');
  const aiDiv=document.getElementById('aiSuggestion');

  try{
    const res=await fetch("http://127.0.0.1:5000/predict",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(data)
    });

    const r=await res.json();

    resultDiv.style.display="block";
    resultDiv.style.background='#123624';
    resultDiv.style.color='#aaffaa';

    const rawText=r.message || 'Prediction complete.';
    const priceText=rawText.split(/[.!\n]/)[0] + ".";
    typeWriter(resultDiv,priceText,30);

    aiDiv.style.display="block";
    aiDiv.textContent="Thinking of best matches...";

    const aiRes=await fetch("http://127.0.0.1:5000/suggest",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({price:r.prediction})
    });

    const aiData=await aiRes.json();
    aiDiv.textContent=aiData.suggestion || "No suggestion available.";

  }catch(e){
    resultDiv.style.display="block";
    resultDiv.style.background='#3a1e1e';
    resultDiv.style.color='#ffbaba';
    resultDiv.textContent='Network error.';
  }
});
</script>

</body>
</html>

